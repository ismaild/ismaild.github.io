<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: mac | CODIEZ]]></title>
  <link href="http://blog.codiez.co.za/categories/mac/atom.xml" rel="self"/>
  <link href="http://blog.codiez.co.za/"/>
  <updated>2013-11-10T12:56:23+02:00</updated>
  <id>http://blog.codiez.co.za/</id>
  <author>
    <name><![CDATA[Ismail Dhorat]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Setup Oracle instant client and ruby oci8 gem on Mac]]></title>
    <link href="http://blog.codiez.co.za/2013/09/setup-oracle-instant-client-ruby-oci8-gem-mac/"/>
    <updated>2013-09-12T22:17:00+02:00</updated>
    <id>http://blog.codiez.co.za/2013/09/setup-oracle-instant-client-ruby-oci8-gem-mac</id>
    <content type="html"><![CDATA[<p>Recently i have had to get my dev environment setup to connect to oracle for a project.</p>

<p>Getting the client setup can sometimes be a real pain with a Mac. Oracle does provide client libraries but they are painfully slow in updating them and fixing bugs. There was an <a href="https://forums.oracle.com/thread/2320019?start=0&amp;tstart=0">outstanding segmentation fault bug for over 2 years</a>.</p>

<p>Here are the steps to get it setup on Mac, and it would probably work for ubuntu etc, just have not tested it.</p>

<p>First grab the 64 bit client from:</p>

<p><a href="http://www.oracle.com/technetwork/topics/intel-macsoft-096467.html">http://www.oracle.com/technetwork/topics/intel-macsoft-096467.html</a></p>

<p>You need:</p>

<ul>
<li>instantclient-basic-macos.x64-11.2.0.3.0.zip</li>
<li>instantclient-sqlplus-macos.x64-11.2.0.3.0.zip</li>
<li>instantclient-sdk-macos.x64-11.2.0.3.0.zip</li>
</ul>


<p>You can also grab the lite version, if you do not need any translations.</p>

<p>Unzip the files:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> ~/Downloads&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;basic&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;unzip -qq instantclient-basic-macos.x64-11.2.0.3.0.zip&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;lite&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;unzip -qq instantclient-basiclite-macos.x64-11.2.0.3.0.zip&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;unzip -qq instantclient-sqlplus-macos.x64-11.2.0.3.0.zip&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;unzip -qq instantclient-sdk-macos.x64-11.2.0.3.0.zip
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>Move files</h2>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd </span>instantclient_11_2
</span><span class='line'>mkdir -p /usr/local/oracle/product/instantclient_64/11.2.0.3.0/bin
</span><span class='line'>mkdir -p /usr/local/oracle/product/instantclient_64/11.2.0.3.0/lib
</span><span class='line'>mkdir -p /usr/local/oracle/product/instantclient_64/11.2.0.3.0/jdbc/lib
</span><span class='line'>mkdir -p /usr/local/oracle/product/instantclient_64/11.2.0.3.0/rdbms/jlib
</span><span class='line'>mkdir -p /usr/local/oracle/product/instantclient_64/11.2.0.3.0/sqlplus/admin
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mv ojdbc&lt;em&gt; /usr/local/oracle/product/instantclient_64/11.2.0.3.0/jdbc/lib/
</span><span class='line'>mv x&lt;/em&gt;.jar /usr/local/oracle/product/instantclient_64/11.2.0.3.0/rdbms/jlib/&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;rename glogin.sql to login.sql&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;mv glogin.sql /usr/local/oracle/product/instantclient_64/11.2.0.3.0/sqlplus/admin/login.sql&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Move lib &amp;amp; sdk&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;mv &lt;em&gt;dylib&lt;/em&gt; /usr/local/oracle/product/instantclient_64/11.2.0.3.0/lib/
</span><span class='line'>mv sdk /usr/local/oracle/product/instantclient_64/11.2.0.3.0/lib/sdk&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;mv *README /usr/local/oracle/product/instantclient_64/11.2.0.3.0/
</span><span class='line'>mv * /usr/local/oracle/product/instantclient_64/11.2.0.3.0/bin/
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>Setup TNS Names</h2>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mkdir -p /usr/local/admin/network
</span><span class='line'>touch /usr/local/admin/network/tnsnames.ora
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Put in your tnsnames, example:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>tnsnames.ora </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'> ORADEMO=
</span><span class='line'> (description=
</span><span class='line'>   (address_list=&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt; (address = (protocol = TCP)(host = 127.0.0.1)(port = 1521))
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   )
</span><span class='line'> (connect_data =
</span><span class='line'>   (service_name=orademo)
</span><span class='line'> )
</span><span class='line'>)
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>Setup your environment</h2>

<p>Create a file to store your oracle client environment variables with <code>touch ~/.oracle_client</code></p>

<p>Add the following to it:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>.oracle_client </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export ORACLE_BASE=/usr/local/oracle
</span><span class='line'>export ORACLE_HOME=$ORACLE_BASE/product/instantclient_64/11.2.0.3.0
</span><span class='line'>export PATH=$ORACLE_HOME/bin:$PATH
</span><span class='line'>export DYLD_LIBRARY_PATH=$ORACLE_HOME/lib:$DYLD_LIBRARY_PATH
</span><span class='line'>export TNS_ADMIN=$ORACLE_BASE/admin/network
</span><span class='line'>export SQLPATH=$ORACLE_HOME/sqlplus/admin</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Then run:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='text'><span class='line'>echo &amp;ldquo;source ~/.oracle_client&amp;rdquo; &gt;&gt; ~/.bash_profile
</span><span class='line'>source ~/.bash_profile
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Which will add the environment variables to your <code>.bash_profile</code>, You can also find this in my <a href="https://github.com/ismaild/dotfiles">dotfiles</a></p>

<h2>Test Sql*Plus works</h2>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sqlplus user/pass@orademo&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;SQL*Plus: Release 11.2.0.3.0 Production on Thu Sep 12 09:19:55 2013&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Copyright &amp;copy; 1982, 2012, Oracle.  All rights reserved.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Connected to:
</span><span class='line'>Oracle Database 11g Enterprise Edition Release 11.2.0.2.0 &amp;ndash; 64bit Production
</span><span class='line'>With the Partitioning, OLAP, Data Mining and Real Application Testing options&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;SQL&gt; <span class="k">select </span>table_name from user_tables;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>You could also store multiple versions of the client, with different <code>.oracle_client</code> files, with a small shell script you could switch between different versions (i.e like when oracle does not fix a bug for 2 years! )</p>

<h2>Install Ruby oci gem</h2>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd</span> /usr/local/oracle/product/instantclient_64/11.2.0.3.0/lib
</span><span class='line'>ln -s libclntsh.dylib.11.1 libclntsh.dylib
</span><span class='line'>ln -s libocci.dylib.11.1 libocci.dylib&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Make sure sdk directory is in /usr/local/oracle/product/instantclient_64/11.2.0.3.0/lib&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem install ruby-oci8
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Test that it works&hellip;</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">irb</span>
</span><span class='line'><span class="n">irb</span><span class="p">(</span><span class="n">main</span><span class="p">):</span><span class="mo">001</span><span class="p">:</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nb">require</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">oci8</span>
</span><span class='line'><span class="n">irb</span><span class="p">(</span><span class="n">main</span><span class="p">):</span><span class="mo">006</span><span class="p">:</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">o</span> <span class="o">=</span> <span class="no">OCI8</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="err">&#39;</span><span class="n">user</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">pass</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="mi">127</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">orademo</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;)</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="c1">#&amp;lt;OCI8:user&gt;</span>
</span><span class='line'><span class="n">irb</span><span class="p">(</span><span class="n">main</span><span class="p">):</span><span class="mo">011</span><span class="p">:</span><span class="mi">0</span><span class="o">&gt;</span> <span class="n">o</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="nb">select</span> <span class="o">*</span> <span class="n">from</span> <span class="n">dual</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;)</span> <span class="k">do</span> <span class="o">|</span><span class="n">r</span><span class="o">|</span> <span class="nb">puts</span> <span class="n">r</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;);</span> <span class="k">end</span>
</span><span class='line'><span class="n">X</span>
</span><span class='line'><span class="o">=&gt;</span> <span class="mi">1</span>
</span><span class='line'><span class="n">irb</span><span class="p">(</span><span class="n">main</span><span class="p">):</span><span class="mo">012</span><span class="p">:</span><span class="mi">0</span><span class="o">&gt;</span> <span class="nb">exit</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>If you have issues connecting with an SID or Service Name, try using the IP.</p>

<p>You now have a working oracle database client, and can connect to it from ruby.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Uninstall MySQL & MacPorts, reinstall MySQL with Homebrew on Mac OSX]]></title>
    <link href="http://blog.codiez.co.za/2013/08/uninstall-mysql-macports-install-homebrew-mac-osx/"/>
    <updated>2013-08-27T08:58:00+02:00</updated>
    <id>http://blog.codiez.co.za/2013/08/uninstall-mysql-macports-install-homebrew-mac-osx</id>
    <content type="html"><![CDATA[<p>I have recently have to set up my dev environment once again, which can be quite a bit of a pain, especially if you do not have something like <a href="http://boxen.github.com/">boxen</a>.</p>

<p>This time however i decided to avoid macports all together, one of the &ldquo;benefits&rdquo; of macports over homebrew is the ability to run different versions since macports will install into /opt , though its a feature i never used, and i have had a bunch of strange build incompatabilities that has taken me quite a bit of time to debug.</p>

<p>Here are the steps</p>

<h2>Uninstall macports</h2>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo port -fp uninstall &amp;mdash;follow-dependents installed
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo rm -rf /opt/local
</span><span class='line'>sudo rm -rf /Applications/DarwinPorts
</span><span class='line'>sudo rm -rf /Applications/MacPorts
</span><span class='line'>sudo rm -rf /Library/LaunchDaemons/org.macports.&lt;em&gt;
</span><span class='line'>sudo rm -rf /Library/Receipts/DarwinPorts&lt;/em&gt;.pkg
</span><span class='line'>sudo rm -rf /Library/Receipts/MacPorts*.pkg
</span><span class='line'>sudo rm -rf /Library/StartupItems/DarwinPortsStartup
</span><span class='line'>sudo rm -rf /Library/Tcl/darwinports1.0
</span><span class='line'>sudo rm -rf /Library/Tcl/macports1.0
</span><span class='line'>sudo rm -rf ~/.macports
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>Uninstall MySQL</h2>

<ol>
<li>Backup any databases you have using mysqldump</li>
<li>Stop MySQL if it is currently running, under settings > mysql</li>
</ol>


<p>and then run:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo rm /usr/local/mysql
</span><span class='line'>sudo rm -rf /usr/local/mysql&lt;em&gt;
</span><span class='line'>sudo rm -rf /Library/StartupItems/MySQLCOM
</span><span class='line'>sudo rm -rf /Library/PreferencePanes/My&lt;/em&gt;
</span><span class='line'>sudo rm -rf /Library/Receipts/mysql&lt;em&gt;
</span><span class='line'>sudo rm -rf /Library/Receipts/MySQL&lt;/em&gt;
</span><span class='line'>sudo rm -rf /private/var/db/receipts/&lt;em&gt;mysql&lt;/em&gt;
</span><span class='line'>rm -rf ~/Library/PreferencePanes/My*
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>You may also need to edit <code>/etc/hostconfig</code> and remove the line <code>MYSQLCOM=-YES-</code></p>

<h2>Install Homebrew &amp; MySQL</h2>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>ruby -e &amp;ldquo;<span class="k">$(</span>curl -fsSL &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://raw.github.com/mxcl/homebrew/go&quot;</span>&gt;https://raw.github.com/mxcl/homebrew/go&lt;/a&gt;<span class="k">)</span>&amp;rdquo;
</span><span class='line'>brew install mysql
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Welcome to <a href="http://www.youtube.com/watch?v=hNVu55ZyC-Y&amp;list=PL7AD6AA21F4F0E76E">nirvana</a></p>

<p>:)</p>

<p>Seriously, i have not yet had any compatibility or weird build errors with homebrew.</p>
]]></content>
  </entry>
  
</feed>
